graph TD
    subgraph "–ö–û–ù–¢–£–† 1: OFFLINE (–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è)"
        direction LR
        
        DS("<b>–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö</b><br>- –í–µ–±-—Å–∞–π—Ç<br>- Excel, PDF, Docx")
        
        Chunker("<b>1. –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ</b><br><i>–§—É–Ω–∫—Ü–∏—è:</i> –î–µ–ª–∏—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞<br>—Å–º—ã—Å–ª–æ–≤—ã–µ –±–ª–æ–∫–∏, –∞ –Ω–µ –ø–æ —Ä–∞–∑–º–µ—Ä—É.<br><b>–°—Ç–µ–∫: Semantic Chunker</b>")
        
        subgraph "2. –ú—É–ª—å—Ç–∏-–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è"
            direction TB
            EmbeddingModel("<b>2–∞. –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</b><br><b>–°—Ç–µ–∫: SentenceTransformers</b>")
            VectorDB("<b>–í–µ–∫—Ç–æ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å (Vector Store)</b><br><i>–î–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞.</i><br><b>–°—Ç–µ–∫: ChromaDB / FAISS</b>")
            KeywordIndex("<b>–ò–Ω–¥–µ–∫—Å –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º</b><br><i>–î–ª—è –ø–æ–∏—Å–∫–∞ —Ç–æ—á–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤.</i><br><b>–°—Ç–µ–∫: BM25</b>")
        end
        
        DS --> Chunker
        Chunker -- "–°–º—ã—Å–ª–æ–≤—ã–µ —á–∞–Ω–∫–∏" --> EmbeddingModel
        Chunker -- "–¢–µ–∫—Å—Ç —á–∞–Ω–∫–æ–≤" --> KeywordIndex
        EmbeddingModel -- "–í–µ–∫—Ç–æ—Ä—ã" --> VectorDB
    end

    subgraph "–ö–û–ù–¢–£–† 2: ONLINE (–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç—Å–∫–∏–π –ø–∞–π–ø–ª–∞–π–Ω)"
        direction TB

        User[("üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å")]
        
        Router("<b>A. –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞ (Query Router)</b><br><i>–§—É–Ω–∫—Ü–∏—è:</i> '–ú–æ–∑–≥' —Å–∏—Å—Ç–µ–º—ã. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å<br>–∏ —Ä–µ—à–∞–µ—Ç, –∫–∞–∫—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.<br><b>–°—Ç–µ–∫: LLM —Å Chain of Thought</b>")

        subgraph "B. –ì–∏–±—Ä–∏–¥–Ω—ã–π –ü–æ–∏—Å–∫ –∏ –£–ª—É—á—à–µ–Ω–∏–µ"
            direction TB
            QueryAugmentation("<b>B.1 –£–ª—É—á—à–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ (Query Augmentation)</b><br><i>–§—É–Ω–∫—Ü–∏—è:</i> –ü–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä–æ–≤–∞–Ω–∏–µ, HyDE.")
            
            subgraph "B.2 –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫"
                direction LR
                VectorSearch("<b>–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫</b>")
                KeywordSearch("<b>–ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–∞–º</b>")
            end
            
            Fusion("<b>B.3 –°–ª–∏—è–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (RRF)</b><br><i>–§—É–Ω–∫—Ü–∏—è:</i> –£–º–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã<br>–∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º.<br><b>–°—Ç–µ–∫: Reciprocal Rank Fusion</b>")
        end
        
        subgraph "C. –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞, –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ü—Ä–æ–≤–µ—Ä–∫–∞"
            direction TB
            Reranker("<b>C.1 –ü–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ (Re-ranker)</b><br><i>–§—É–Ω–∫—Ü–∏—è:</i> –¢–æ—á–Ω–æ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤.<br><b>–°—Ç–µ–∫: Cross-Encoder</b>")
            
            Compressor("<b>C.2 –°–∂–∞—Ç–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (Context Compressor)</b><br><i>–§—É–Ω–∫—Ü–∏—è:</i> –û—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.<br><b>–°—Ç–µ–∫: LLMChainExtractor</b>")

            LLM("<b>C.3 –ì–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–∞—è LLM</b><br><i>–§—É–Ω–∫—Ü–∏—è:</i> –°–æ–∑–¥–∞–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ<br>–æ—á–∏—â–µ–Ω–Ω–æ–≥–æ –∏ —Å–∂–∞—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.<br><b>–°—Ç–µ–∫: Ollama + Llama 3</b>")
            
            GroundingCheck("<b>C.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ (Grounding Check)</b><br><i>–§—É–Ω–∫—Ü–∏—è:</i> –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞<br>–Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –∏ '–∑–∞–∑–µ–º–ª–µ–Ω–Ω–æ—Å—Ç—å'.")
        end

        User -- "1. –ó–∞–ø—Ä–æ—Å" --> Router
        Router -- "2. –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ + –∑–∞–ø—Ä–æ—Å" --> QueryAugmentation
        QueryAugmentation -- "3. –£–ª—É—á—à–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã" --> VectorSearch & KeywordSearch
        
        VectorSearch -- "–ö–∞–Ω–¥–∏–¥–∞—Ç—ã 1" --> Fusion
        KeywordSearch -- "–ö–∞–Ω–¥–∏–¥–∞—Ç—ã 2" --> Fusion
        
        Fusion -- "4. –ï–¥–∏–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤" --> Reranker
        Reranker -- "5. –õ—É—á—à–∏–µ N –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤" --> Compressor
        Compressor -- "6. –°–∂–∞—Ç—ã–π, –∫—Ä–∏—Å—Ç–∞–ª—å–Ω–æ —á–∏—Å—Ç—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç" --> LLM
        LLM -- "7. –ß–µ—Ä–Ω–æ–≤–æ–π –æ—Ç–≤–µ—Ç" --> GroundingCheck
        GroundingCheck -- "8. –§–∏–Ω–∞–ª—å–Ω—ã–π, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π –æ—Ç–≤–µ—Ç" --> User
        
        %% –°–≤—è–∑–∏ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ –∏–∑ Offline-–∫–æ–Ω—Ç—É—Ä–∞
        VectorDB -.-> VectorSearch
        KeywordIndex -.-> KeywordSearch
    end

    %% –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–µ–≤—ã—Ö –º–æ–¥—É–ª–µ–π
    style Router fill:#ffcc99,stroke:#333
    style Fusion fill:#ffcc99,stroke:#333
    style Compressor fill:#ffcc99,stroke:#333
    style Reranker fill:#fff8c4,stroke:#333
    style GroundingCheck fill:#f9caca,stroke:#333
    style LLM fill:#cde4f7,stroke:#333
    style VectorDB fill:#d6f5d6,stroke:#333
    style KeywordIndex fill:#d6f5d6,stroke:#333